# 6. Internationalization (i18n)

**Related TRDs**: [12-notifications](./12-notifications.md), [13-newsletter](./13-newsletter.md)  
**Related ADRs**: [ADR-002](./adr/002-trilingual-day1.md)  
**Phase**: MVP (Phase 1)

---

### Supported Languages

- **English** (default) - en-US
- **Korean** - ko-KR
- **Spanish** - es-ES

### Language Selection & Storage

- Parent selects preferred language during registration.
- Language preference stored in User record (`language` field).
- Language sent in JWT token for every request.
- Client includes `Accept-Language` header on API requests (e.g., `Accept-Language: ko-KR`).
- Server uses JWT language preference as primary, falls back to `Accept-Language` header.

### Server-Side Rendering

All server-generated content (notifications, emails, newsletters) is rendered in the recipient's preferred language:

1. Fetch notification template for the recipient's language.
2. Render template with personalization tokens.
3. Dispatch to appropriate channel (SMS, email, push, etc.).

### Client-Side i18n

Frontend uses key-based translation files:

```
/locales/
  en.json
  ko.json
  es.json
```

Each file contains key-value pairs:

```json
{
  "common.hello": "Hello",
  "common.goodbye": "Goodbye",
  "member.profile.name": "Name",
  "member.profile.belt": "Belt Level",
  ...
}
```

Client loads appropriate locale file based on user's language preference and renders UI accordingly.

### Notification Templates

Admin creates notification templates with per-language variants:

**Template Storage**:
- One `NotificationTemplate` record per language per notification type.
- Template body contains personalization tokens: `{{member_name}}`, `{{days_absent}}`, `{{balance_due}}`, `{{belt_level}}`, `{{simsa_date}}`, `{{gym_name}}`, etc.

**Example**:
- English: "Hi {{parent_name}}, {{member_name}} checked in at {{gym_name}} at {{check_in_time}}."
- Korean: "안녕하세요 {{parent_name}}님, {{member_name}}이(가) {{check_in_time}}에 {{gym_name}}에 입장했습니다."
- Spanish: "Hola {{parent_name}}, {{member_name}} se registró en {{gym_name}} a las {{check_in_time}}."

### Cultural UX Patterns

- **Korean Communications**: Use appropriate honorific forms (존칭어). Address parents as "님" (nim). Use formal verb endings.
- **Spanish Communications**: Use formal "usted" form instead of informal "tú".
- **Date/Time Formatting**:
  - English: MM/DD/YYYY, 12-hour time (e.g., "02/25/2026, 3:30 PM")
  - Korean: YYYY년 MM월 DD일, 24-hour time (e.g., "2026년 2월 25일, 15:30")
  - Spanish: DD/MM/YYYY, 24-hour time (e.g., "25/02/2026, 15:30")
- **Currency**: Always USD, but formatted per locale:
  - English: "$99.99"
  - Korean: "$99.99" (same)
  - Spanish: "$99,99" (comma as decimal separator in some regions)


### Implementation Notes

> _This section will be updated as the feature is implemented._

- **Module location**: _TBD_
- **Key files**: _TBD_
- **Actual endpoints**: _TBD_
- **Deviations from spec**: _None yet_
- **Edge cases discovered**: _None yet_
- **Configuration**: _TBD_
